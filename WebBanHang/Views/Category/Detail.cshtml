
@{
    @model GroupProduct
    ViewBag.Title = Model.GroupName;
}

<div class="breadcrumb">
    <div class="container">
        <div class="breadcrumb-inner">
            <ul class="list-inline list-unstyled">
                <li>@Html.ActionLink("Trang chủ","Index","Home")</li>
                @ShowBreadcrumb(Model)
            </ul>
        </div>
        <!-- /.breadcrumb-inner -->
    </div>
    <!-- /.container -->
</div>
<!-- /.breadcrumb -->
<div class="body-content">
    <div class='container'>
        <div class='row outer-bottom-sm'>
            <div class='col-md-3 sidebar'>
                <div class="sidebar-module-container">
                    <h3 class="section-title">@Model.GroupName</h3>
                    <div class="sidebar-filter">
                        <!-- ============================================== SIDEBAR CATEGORY ============================================== -->
                        @Html.Action("ListGroupProduct", new { id = Model.GroupID})
                        <!-- /.sidebar-widget -->
                        <!-- ============================================== SIDEBAR CATEGORY : END ============================================== -->
                        <!-- ============================================== PRICE SILDER============================================== -->
                        <div class="sidebar-widget outer-bottom-xs wow fadeInUp">
                            <div class="widget-header">
                                <h4 class="widget-title">Lọc theo giá</h4>
                            </div>
                            <div class="sidebar-widget-body">
                                <ul class="list">
                                    <li><a href="?@Url.QueryString("range_price","0,10000000")">0&nbsp;₫ - 10.000.000&nbsp;₫ </a></li>
                                    <li><a href="?@Url.QueryString("range_price", "10000000,20000000")">10.000.000&nbsp;₫ - 20.000.000&nbsp;₫ </a></li>
                                    <li><a href="?@Url.QueryString("range_price", "20000000,30000000")">20.000.000&nbsp;₫ - 30.000.000&nbsp;₫ </a></li>
                                    <li><a href="?@Url.QueryString("range_price", "30000000,40000000")">30.000.000&nbsp;₫ - 40.000.000&nbsp;₫ </a></li>
                                    <li><a href="?@Url.QueryString("range_price", "40000000,50000000")">40.000.000&nbsp;₫ - 50.000.000&nbsp;₫ </a></li>
                                </ul>
                                <div>Hoặc chọn giá khác</div>
                                <div class="price-range-holder m-t-10">
                                    <span class="min-max">
                                        <span class="pull-left">0đ</span>
                                        <span class="pull-right">50.000.000đ</span>
                                    </span>
                                    <input type="text" id="amount" style="border:0; color:#666666; font-weight:bold;text-align:center;">
                                    <input type="text" class="price-slider" value="">

                                </div>
                                <!-- /.price-range-holder -->
                                <a href="#" id="btn_price_filter" class="lnk btn btn-primary">Lọc</a>
                            </div>
                            <!-- /.sidebar-widget-body -->
                        </div>
                        <!-- /.sidebar-widget -->
                        <!-- ============================================== PRICE SILDER : END ============================================== -->
                       <!-- ============================================== COLOR============================================== -->
                        <div class="sidebar-widget wow fadeInUp outer-bottom-xs ">
                            <div class="widget-header">
                                <h4 class="widget-title">Lọc theo màu</h4>
                            </div>
                            <div class="sidebar-widget-body m-t-10">
                                <ul class="list list-color">
                                    @foreach (Color color in (IEnumerable<Color>)ViewData["ListColor"])
                                    {
                                        String colorID = HttpContext.Current.Request.QueryString["color"];
                                        String active = "";
                                        if(color.ColorID.ToString().Equals(colorID))
                                        {
                                            active = "active";
                                        }
                                        <li><a class="@active" data-toggle="tooltip" title="Màu @color.ColorName" style="background:#@color.HexCode" href="?@Url.QueryString("color",@color.ColorID.ToString())"></a></li>
                                    }
                                </ul>
                                <div class="clearfix"></div>
                            </div>
                            <!-- /.sidebar-widget-body -->
                        </div>
                        <!-- /.sidebar-widget -->
                        <!-- ============================================== COLOR: END ============================================== -->
                        <!-- ============================================== COMPARE============================================== -->
                        <div class="sidebar-widget wow fadeInUp">
                            <h3 class="section-title">Compare products</h3>
                            <div class="sidebar-widget-body">
                                <div class="compare-report">
                                    <p>You have no <span>item(s)</span> to compare</p>
                                </div>
                                <!-- /.compare-report -->
                            </div>
                            <!-- /.sidebar-widget-body -->
                        </div>
                        <!-- /.sidebar-widget -->
                        <!-- ============================================== COMPARE: END ============================================== -->
                        <!-- ============================================== PRODUCT TAGS ============================================== -->
                        <div class="sidebar-widget product-tag wow fadeInUp">
                            <h3 class="section-title">Product tags</h3>
                            <div class="sidebar-widget-body outer-top-xs">
                                <div class="tag-list">
                                    <a class="item" title="Phone" href="category.html">Phone</a>
                                    <a class="item active" title="Vest" href="category.html">Vest</a>
                                    <a class="item" title="Smartphone" href="category.html">Smartphone</a>
                                    <a class="item" title="Furniture" href="category.html">Furniture</a>
                                    <a class="item" title="T-shirt" href="category.html">T-shirt</a>
                                    <a class="item" title="Sweatpants" href="category.html">Sweatpants</a>
                                    <a class="item" title="Sneaker" href="category.html">Sneaker</a>
                                    <a class="item" title="Toys" href="category.html">Toys</a>
                                    <a class="item" title="Rose" href="category.html">Rose</a>
                                </div>
                                <!-- /.tag-list -->
                            </div>
                            <!-- /.sidebar-widget-body -->
                        </div>
                        <!-- /.sidebar-widget -->
                        <!-- ============================================== PRODUCT TAGS : END ============================================== -->
                        <!-- ============================================== COLOR============================================== -->
                        <div class="sidebar-widget  wow fadeInUp outer-top-vs ">
                            <div id="advertisement" class="advertisement">
                                <div class="item bg-color">
                                    <div class="container-fluid">
                                        <div class="caption vertical-top text-left">
                                            <div class="big-text">
                                                Save<span class="big">50%</span>
                                            </div>

                                            <div class="excerpt">
                                                on selected items
                                            </div>
                                        </div>
                                        <!-- /.caption -->
                                    </div>
                                    <!-- /.container-fluid -->
                                </div>
                                <!-- /.item -->
                                <div class="item" style="background-image: url('assets/images/advertisement/1.jpg');">

                                </div>
                                <!-- /.item -->
                                <div class="item bg-color">
                                    <div class="container-fluid">
                                        <div class="caption vertical-top text-left">
                                            <div class="big-text">
                                                Save<span class="big">50%</span>
                                            </div>

                                            <div class="excerpt fadeInDown-2">
                                                on selected items
                                            </div>
                                        </div>
                                        <!-- /.caption -->
                                    </div>
                                    <!-- /.container-fluid -->
                                </div>
                                <!-- /.item -->
                            </div>
                            <!-- /.owl-carousel -->
                        </div>

                        <!-- ============================================== COLOR: END ============================================== -->
                    </div>
                    <!-- /.sidebar-filter -->
                </div>
                <!-- /.sidebar-module-container -->
            </div>
            <!-- /.sidebar -->
            @Html.Action("ShowProductInCategory", new { id = Model.GroupID })
            <!-- /.col -->
        </div>
        <!-- /.row -->
    </div>
    <!-- /.container -->
</div>
<!-- /.body-content -->


@helper ShowBreadcrumb(GroupProduct group, int currGroupID = -1)
{
    if (currGroupID == -1)
    {
        currGroupID = group.GroupID;
    }
    
    if (group.ParentGroupID != null)
    {
        @ShowBreadcrumb(group.GroupProduct1, currGroupID)
    }
    if (group.GroupID == currGroupID)
    {
        <li class="active">@group.GroupName</li>
    }
    else
    {
        <li><a href="@Url.Action("Detail", new { id = group.GroupID })">@group.GroupName</a></li>
    }
}

@section masterjs
{
    <script type="text/javascript">
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
            $("#btn_price_filter").click(function () {
                url = replaceParam('range_price', $(".price-slider").val());
                window.location.href = url;
                return false;
            });
        }); 
        function replaceParam(key, value) {
            var pathname = window.location.pathname;
            var params = toParams(window.location.search);
            params[key] = value;

            return pathname + "?" + jQuery.param(params)
        }

        function toParams(searchUrl) {
            var result = {}
            if (searchUrl == '')
                return result;

            var queryString = searchUrl.substr(1);

            var params = queryString.split("&");

            jQuery.each(params, function (index, param) {
                var keyPair = param.split("=");

                var key = keyPair[0];
                var value = keyPair[1];

                if (result[key] == undefined)
                    result[key] = value
                else {

                    if (result[key] instanceof Array) //current var is an array just push another to it
                        result[key].push(value)
                    else { //duplicate var, then it must store as an array
                        result[key] = [result[key]]
                        result[key].push(value)
                    }
                }
            })

            return result;

        }
    </script>
}